# Item Catalog
The following is a Flask full stack application demonstrating authentication using Google's oauth API.
The Top Furniture Catalog is a collection of furniture inventory for a store. Log in to add furniture to the collection using
your Google Account.

Catalog has been updated to run on Linux Ubuntu Server with PostgreSQL and Apache
Users are only allowed to update their own items.

## How to Install

### Google Account
Must have a Google account to log in to the system from the web browser.

### Server Information
IP Address: 54.90.118.51
SSH Port: 2200

### Server Configuration
Server is hosted on AWS Lightsail using the key pair (private key) created for the account.
1. Update and Upgrade Available packages: `sudo apt-get update` `sudo apt-get upgrade`
2. Add users to server using `sudo adduser username` and configure superusers.
3. Create public key for users using `ssh_keygen usercodefile`. 
4. Make file for authorized keys. `mkdir .ssh`. `touch .ssh\authorized_keys`. Add public keys generated by ssh_keygen to authorized_keys file.
5. Run `chmod 700 .ssh`. Then `chmod 644 .ssh\authorized_keys` to have the right permissions on those files.
6. Force Key based authentication by `sudo nano /etc/ssh/ssh_config`. Change `Password Athentication` to No. Set `PermitRootLogin` is set to No. Save and restart ssh `sudo service ssh restart`
7. Configure Firewall
Before updating ufw on server. Login to AWS Management Console for the server. In Networking tab, update Firewall settings to allow ports 80, 2200, 123.
  a. `sudo ufw default deny incoming`
  b. `sudo ufw default allow outgoing`
  c. `sudo ufw allow ssh`
  d. `sudo ufw allow 2200`
  e. `sudo ufw allow www`
  f. `sudo ufw allow 123`
  f. `sudo ufw enable`
 8. Install libraries and packages needed for application listed below.
 9. Clone repository to the /var/www/ directory. 

### Libraries and Package Installations
The following libraries need to be installed for the web server to run.
1. Flask: `pip install Flask` . For more documentation, visit [Flask Documentation](http://flask.pocoo.org/docs/1.0/installation/)
2. Flask HTTPAuth: `pip install flask_httpauth`. For more documentation, visit [Flask-HTTPAuth Documentation](https://flask-httpauth.readthedocs.io/en/latest/)

3. SQL Alchemy: `pip install SQLAlchemy`. [SQL Alchemy Documentation](https://pypi.org/project/SQLAlchemy/)
4. Oauth2Client: `pip install oauth2client` . [Oauth2Client](https://pypi.org/project/oauth2client/)
5. Flask-Login: `pip install flask-login`. [Flask-Login](https://flask-login.readthedocs.io/en/latest/#flask_login.LoginManager)
6. PostgreSql: `sudo apt-get install postgresql`[PostgreSql](https://www.godaddy.com/garage/how-to-install-postgresql-on-ubuntu-14-04/)
7. PassLIb: `sudo pip install passlib`
8. Request: `sudo pip install requests`
9. Apache: `sudo apt update` `sudo apt install apache2`. Steps to Install Server and Virtual host in References below under How to Install Apache Web Server on Ubuntu.
10. VirtualEnv: `sudo pip install virtualenv`.

### Apache Configuration
1. Update configurations file with server name, alias, and flask app configuration directory information. See Reference How to Deploy a Flask Application on Ubuntu Server below.
2. Disable Default Apache virtual host `sudo a2dissite default`. See Reference below.

### Database Configuration
1. Create user 'catalog' for server.
2. Use user 'catalog' to create user 'catalog' for PSQL.
3. Create password for PSQL user 'catalog' using: `ALTER USER catalog PASSWORD '#######`
4. Create itemCatalog database.
5. Create User, Item, and Category tables:

```CREATE TABLE category (
	id SERIAL, 
	name TEXT, 
	PRIMARY KEY (id)
);

CREATE TABLE users (
	id SERIAL, 
	username TEXT, 
	password_hash TEXT, 
	email TEXT, 
	picture TEXT,
	PRIMARY KEY (id)
);

CREATE TABLE item (
	id SERIAL, 
	name TEXT, 
	picture TEXT, 
	description TEXT, 
	price TEXT, 
	category_id INTEGER, 
	user_id INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY (category_id) REFERENCES category (id), 
	FOREIGN KEY (user_id) REFERENCES users (id)
);
```

## To View Website
Open browser to `http://54.90.118.51.xip.io:80`
IP Address: 54.90.118.51
Port: 80

## Style References
[Bootstrap 4.3.1](https://getbootstrap.com/docs/4.3/layout/overview/)

[Libraries for File Upload](http://flask.pocoo.org/docs/1.0/patterns/fileuploads/)

## References
1.[Flexbox Solution for Horizontal Scrolling](https://codeburst.io/how-to-create-horizontal-scrolling-containers-d8069651e9c6)

2.[Card Hover Effects](https://codepen.io/jasonheecs/pen/GNNwpZ)

3.[Flask Login Tutorial](https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-v-user-logins)

4.[Add Google Oauth to Flask Application](https://medium.com/@bittu/add-google-oauth2-login-in-your-flask-web-app-9f455695341e)

5.[How to Deploy a Flask Applcation on Ubuntu Server](https://www.digitalocean.com/community/tutorials/how-to-deploy-a-flask-application-on-an-ubuntu-vps)

6.[How to Install PostgreSQL on Ubuntu](https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-ubuntu-16-04)

7.[Migrating SQLite to PostgreSQL](https://tutorialinux.com/today-learned-migrating-sqlite-postgres-easy-sequel/)

8.[How to Install Apache Web Server on Ubuntu](https://www.digitalocean.com/community/tutorials/how-to-install-the-apache-web-server-on-ubuntu-18-04-quickstart)

9.[How to Install Linux Apache MySQL PHP LAMP Stack on Ubuntu](https://www.digitalocean.com/community/tutorials/how-to-install-linux-apache-mysql-php-lamp-stack-on-ubuntu-16-04)

10.[How do i remove Apache2 Ubuntu Default Page?](https://www.digitalocean.com/community/questions/how-do-i-remove-apache2-ubuntu-default-page)

## Author
Nikiya M. Simpson
Udacity, Full Stack Web Development Program Student, 2019
